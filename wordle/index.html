<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Việt Nam</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #121213;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #ffffff;
        }

        #gameContainer {
            text-align: center;
            max-width: 500px;
            width: 100%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            justify-content: space-between;
        }

        header {
            border-bottom: 1px solid #3a3a3c;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        h1 {
            font-size: 32px;
            letter-spacing: 0.1em;
            font-weight: 700;
            text-transform: uppercase;
        }

        #gameBoard {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            margin: 0 auto;
            width: 300px;
            height: 360px;
            flex-grow: 1;
            align-content: center;
        }

        .row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .tile {
            width: 100%;
            aspect-ratio: 1;
            border: 2px solid #3a3a3c;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 28px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.2s;
            user-select: none;
        }

        .tile.filled {
            animation: pop 0.1s ease-in-out;
            border-color: #565758;
        }

        .tile.correct {
            background-color: #538d4e;
            border-color: #538d4e;
            animation: flip 0.6s ease-in-out;
        }

        .tile.present {
            background-color: #b59f3b;
            border-color: #b59f3b;
            animation: flip 0.6s ease-in-out;
        }

        .tile.absent {
            background-color: #3a3a3c;
            border-color: #3a3a3c;
            animation: flip 0.6s ease-in-out;
        }

        @keyframes pop {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        @keyframes flip {
            0% {
                transform: rotateX(0);
            }

            50% {
                transform: rotateX(90deg);
            }

            100% {
                transform: rotateX(0);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20% {
                transform: translateX(-5px);
            }

            40% {
                transform: translateX(5px);
            }

            60% {
                transform: translateX(-5px);
            }

            80% {
                transform: translateX(5px);
            }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        #keyboard {
            margin: 0 auto;
            width: 100%;
            padding-bottom: 20px;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
            touch-action: manipulation;
        }

        .key {
            flex: 1;
            height: 58px;
            margin: 0 3px;
            background-color: #818384;
            border: none;
            border-radius: 4px;
            color: #ffffff;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            transition: background-color 0.2s;
        }

        .key:active {
            background-color: #565758;
        }

        .key.wide {
            flex: 1.5;
            font-size: 12px;
        }

        .key.correct {
            background-color: #538d4e;
        }

        .key.present {
            background-color: #b59f3b;
        }

        .key.absent {
            background-color: #3a3a3c;
        }

        #message {
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            background: #ffffff;
            color: #000;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            z-index: 2000;
            display: none;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a1b;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            z-index: 1000;
            width: 90%;
            max-width: 400px;
            border: 1px solid #3a3a3c;
        }

        .modal h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }

        .modal button {
            padding: 12px 24px;
            background: #538d4e;
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        .stat-box {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
        }

        .stat-label {
            font-size: 12px;
            color: #aaa;
        }
    </style>
</head>

<body>
    <div id="gameContainer">
        <header>
            <h1>Wordle VN</h1>
        </header>

        <div id="message"></div>

        <div id="gameBoard"></div>

        <div id="keyboard">
            <div class="keyboard-row">
                <button class="key" data-key="q">Q</button>
                <button class="key" data-key="w">W</button>
                <button class="key" data-key="e">E</button>
                <button class="key" data-key="r">R</button>
                <button class="key" data-key="t">T</button>
                <button class="key" data-key="y">Y</button>
                <button class="key" data-key="u">U</button>
                <button class="key" data-key="i">I</button>
                <button class="key" data-key="o">O</button>
                <button class="key" data-key="p">P</button>
            </div>
            <div class="keyboard-row">
                <button class="key" data-key="a">A</button>
                <button class="key" data-key="s">S</button>
                <button class="key" data-key="d">D</button>
                <button class="key" data-key="f">F</button>
                <button class="key" data-key="g">G</button>
                <button class="key" data-key="h">H</button>
                <button class="key" data-key="j">J</button>
                <button class="key" data-key="k">K</button>
                <button class="key" data-key="l">L</button>
            </div>
            <div class="keyboard-row">
                <button class="key wide" data-key="enter">NHẬP</button>
                <button class="key" data-key="z">Z</button>
                <button class="key" data-key="x">X</button>
                <button class="key" data-key="c">C</button>
                <button class="key" data-key="v">V</button>
                <button class="key" data-key="b">B</button>
                <button class="key" data-key="n">N</button>
                <button class="key" data-key="m">M</button>
                <button class="key wide" data-key="backspace">⌫</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="modal" id="gameOverModal">
        <h2 id="modalTitle"></h2>
        <p id="modalMessage"></p>
        <div id="stats" class="stat-box"></div>
        <button onclick="newGame()">Chơi Lại</button>
    </div>

    <script>
        // Vietnamese Word List (Unaccented, 5 letters)
        const wordList = [
            'HANOI', 'DALAT', 'SAIGON', 'BANBE', 'VUIVE', 'MANME', 'YEUOI', 'THUONG', 'NHOAI', 'DITIM',
            'VEQUE', 'ANCOM', 'UONGBI', 'CAFEA', 'TRACHANH', 'BANHMI', 'PHOBO', 'BUNCA', 'MIQUANG',
            'HOAHONG', 'XANHLA', 'DOIMOI', 'TINHYEU', 'GIADINH', 'DATNUOC', 'CONNGUOI', 'NONSONG',
            'BIENCA', 'RUNGXANH', 'MAYTRANG', 'NANGVANG', 'MUAROI', 'GIOMUA', 'BAOTAP', 'SONGIO',
            'BINHMINH', 'HOANGHON', 'DEMTOI', 'NGAYMOI', 'TUONG', 'LAI', 'QUAKHU', 'HIENTAI',
            'THANHCONG', 'THATBAI', 'NOLUC', 'COGAN', 'KIENNHAN', 'DUNGCA', 'MANHME', 'TUTIN',
            'KHIEMTON', 'TRUNGT', 'HIEUTHA', 'TONTRONG', 'DOANKET', 'YEU thuong', 'HANHPHUC',
            'ANLANH', 'MAYMAN', 'TAILOC', 'PHUQUY', 'VINHQUANG', 'TUHAO', 'DANHTU', 'DONGTU',
            'TINHTU', 'SOITOC', 'KHUONMAT', 'NUOCMAT', 'NUOCMAT', 'NUOCMAT', 'NUOCMAT', 'NUOCMAT',
            // Added more common words to ensure playability
            'CHAO', 'NGUOI', 'KHONG', 'NHUNG', 'TRONG', 'DUOC', 'MINH', 'DANG', 'NGAY', 'THANG',
            'NAM', 'VIET', 'NAM', 'QUOC', 'GIA', 'DAN', 'TOC', 'VAN', 'HOA', 'HOC', 'TAP',
            'LAM', 'VIEC', 'CHOI', 'GAME', 'NHAC', 'PHIM', 'ANH', 'EM', 'CHA', 'ME', 'ONG', 'BA'
        ].filter(w => w.length === 5).map(w => w.toUpperCase());

        // Game state
        let currentWord = '';
        let currentRow = 0;
        let currentTile = 0;
        let gameOver = false;
        let guesses = [];

        // Statistics
        let stats = {
            played: 0,
            won: 0,
            streak: 0,
            maxStreak: 0
        };

        function loadStats() {
            const savedStats = localStorage.getItem('wordleVNStats');
            if (savedStats) {
                stats = JSON.parse(savedStats);
            }
        }

        function saveStats() {
            localStorage.setItem('wordleVNStats', JSON.stringify(stats));
        }

        function initBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            for (let i = 0; i < 6; i++) {
                const row = document.createElement('div');
                row.className = 'row';

                for (let j = 0; j < 5; j++) {
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    tile.id = `tile-${i}-${j}`;
                    row.appendChild(tile);
                }

                board.appendChild(row);
            }
        }

        function selectWord() {
            currentWord = wordList[Math.floor(Math.random() * wordList.length)];
            console.log('Đáp án:', currentWord);
        }

        function handleKey(key) {
            if (gameOver) return;

            if (key === 'enter') {
                submitGuess();
            } else if (key === 'backspace') {
                deleteLetter();
            } else if (key.match(/^[a-z]$/)) {
                addLetter(key.toUpperCase());
            }
        }

        function addLetter(letter) {
            if (currentTile < 5) {
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = letter;
                tile.classList.add('filled');
                currentTile++;
            }
        }

        function deleteLetter() {
            if (currentTile > 0) {
                currentTile--;
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = '';
                tile.classList.remove('filled');
            }
        }

        function submitGuess() {
            if (currentTile !== 5) {
                showMessage('Chưa đủ ký tự');
                shakeRow();
                return;
            }

            const guess = getCurrentGuess();

            // Simple validation: allow any 5 letter input for now to avoid frustration with limited dictionary
            // Or strictly check against wordList if it was comprehensive
            // For this clone, we'll be lenient or check if it exists in our list
            /* 
            if (!wordList.includes(guess)) {
                showMessage('Không có trong từ điển');
                shakeRow();
                return;
            }
            */

            guesses.push(guess);
            checkGuess(guess);

            if (guess === currentWord) {
                setTimeout(() => showMessage('Xuất sắc!'), 1500);
                stats.won++;
                stats.streak++;
                stats.maxStreak = Math.max(stats.streak, stats.maxStreak);
                endGame(true);
            } else if (currentRow === 5) {
                setTimeout(() => showMessage(currentWord), 1500);
                stats.streak = 0;
                endGame(false);
            } else {
                currentRow++;
                currentTile = 0;
            }
        }

        function getCurrentGuess() {
            let guess = '';
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                guess += tile.textContent;
            }
            return guess;
        }

        function checkGuess(guess) {
            const letterCount = {};
            for (let letter of currentWord) {
                letterCount[letter] = (letterCount[letter] || 0) + 1;
            }

            const states = new Array(5).fill('absent');

            // First pass: mark correct letters
            for (let i = 0; i < 5; i++) {
                if (guess[i] === currentWord[i]) {
                    states[i] = 'correct';
                    letterCount[guess[i]]--;
                }
            }

            // Second pass: mark present letters
            for (let i = 0; i < 5; i++) {
                if (states[i] === 'absent' && letterCount[guess[i]] > 0) {
                    states[i] = 'present';
                    letterCount[guess[i]]--;
                }
            }

            // Update tiles
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                setTimeout(() => {
                    tile.classList.add(states[i]);
                }, i * 250); // Slower reveal for drama
            }

            // Update keyboard
            setTimeout(() => {
                for (let i = 0; i < 5; i++) {
                    updateKeyboard(guess[i], states[i]);
                }
            }, 1250);
        }

        function updateKeyboard(letter, state) {
            const key = document.querySelector(`[data-key="${letter.toLowerCase()}"]`);
            if (!key) return;

            if (state === 'correct') {
                key.classList.add('correct');
                key.classList.remove('present');
            } else if (state === 'present' && !key.classList.contains('correct')) {
                key.classList.add('present');
            } else if (state === 'absent' && !key.classList.contains('correct') && !key.classList.contains('present')) {
                key.classList.add('absent');
            }
        }

        function showMessage(text) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.style.display = 'block';
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 2000);
        }

        function shakeRow() {
            const row = document.querySelectorAll('.row')[currentRow];
            row.classList.add('shake');
            setTimeout(() => row.classList.remove('shake'), 500);
        }

        function endGame(won) {
            gameOver = true;
            stats.played++;
            saveStats();

            setTimeout(() => {
                showGameOverModal(won);
            }, 2000);
        }

        function showGameOverModal(won) {
            const modal = document.getElementById('gameOverModal');
            const overlay = document.getElementById('overlay');
            const title = document.getElementById('modalTitle');
            const message = document.getElementById('modalMessage');
            const statsEl = document.getElementById('stats');

            title.textContent = won ? 'Chúc Mừng!' : 'Thua Rồi!';
            message.textContent = won ? `Bạn đã đoán đúng từ sau ${currentRow + 1} lần thử!` : `Đáp án là: ${currentWord}`;

            statsEl.innerHTML = `
                <div class="stat-item">
                    <span class="stat-value">${stats.played}</span>
                    <span class="stat-label">Đã chơi</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">${stats.played > 0 ? Math.round(stats.won / stats.played * 100) : 0}%</span>
                    <span class="stat-label">Thắng</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">${stats.streak}</span>
                    <span class="stat-label">Chuỗi</span>
                </div>
            `;

            modal.style.display = 'block';
            overlay.style.display = 'block';
        }

        function newGame() {
            currentRow = 0;
            currentTile = 0;
            gameOver = false;
            guesses = [];

            // Reset board
            const tiles = document.querySelectorAll('.tile');
            tiles.forEach(tile => {
                tile.textContent = '';
                tile.className = 'tile';
            });

            // Reset keyboard
            const keys = document.querySelectorAll('.key');
            keys.forEach(key => {
                key.className = 'key';
                if (key.dataset.key === 'enter' || key.dataset.key === 'backspace') {
                    key.classList.add('wide');
                }
            });

            // Hide modal
            document.getElementById('gameOverModal').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';

            selectWord();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                handleKey('enter');
            } else if (e.key === 'Backspace') {
                handleKey('backspace');
            } else if (e.key.match(/^[a-zA-Z]$/)) {
                handleKey(e.key.toLowerCase());
            }
        });

        document.querySelectorAll('.key').forEach(key => {
            key.addEventListener('click', () => {
                handleKey(key.dataset.key);
            });
        });

        loadStats();
        initBoard();
        selectWord();
    </script>
</body>

</html>